---
title: Excess mortality in Puerto Rico after Hurricane María.
date: 2024-12-16
---
# 1 Abstract (150-200 words)
Purpose: The abstract provides a concise summary of your project, including its objectives, key findings, and significance. Write this section last, after completing all other sections, to accurately reflect your project’s focus and main results.
Guidelines: Limit this section to 150-200 words. Briefly outline the purpose of your study, the approach you used, and the primary results and conclusions. The abstract should be clear, succinct, and give readers an immediate understanding of what your project entails.

# 2 Introduction (500-600 words)
Purpose: The introduction sets the stage for your project, presenting the background and rationale for your analysis. Explain why the topic is significant.
Guidelines: Start with a broad overview of the topic, gradually narrowing down to your specific focus. Conclude with a clear statement of your research questions, hypotheses, or objectives. Use 2-3 paragraphs to establish a solid foundation for the rest of the paper.

# 3 Methods (600-700 words)
Purpose: This section details the data sources, methods, and analytical techniques you used to conduct your analysis. It should be specific enough that someone else could replicate your study using the same resources and approach.
Guidelines: Describe the dataset(s) you used, including information about data collection (e.g., sources, time frame). Outline your approach for cleaning and analyzing the data, including any statistical or computational methods applied. Clearly explain any assumptions or limitations in your approach.

# 4 Results (500-600 words)
Purpose: The results section presents the main findings of your analysis without interpretation. Organize the data logically to highlight key insights, using tables, figures, and charts to illustrate trends and comparisons.
Guidelines: For each result, briefly describe it and refer to relevant visuals or tables where appropriate. Do not provide explanations or discuss implications in this section; focus only on presenting the findings clearly and accurately.

## Prepare
```{r warning = FALSE, message = FALSE}
library(excessmort)
library(dplyr)
library(lubridate)
library(ggplot2)
data("puerto_rico_counts") 
head(puerto_rico_counts)
```
## Task 1

```{r}
population_summary <- puerto_rico_counts |>
  group_by(agegroup, sex) |>
  summarise(mean_population = mean(population, na.rm = TRUE))

print(population_summary)

ggplot(population_summary, aes(x = agegroup, y = mean_population, fill = sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Average Population Size by Age Group and Sex",
       x = "Age Group", y = "Average Population Size") +
  theme_minimal()
```
In the younger age group, under 14 years, male has higher proportion than female. This might be because of the notion that some of the family willingly prefer having boy baby than  girl. Besides, the sex ratio at born is around 105-107 boys versus 100 girls globally.

In the working age group, 20-49, female has higher proportion than male. This might be because male moving out for work or moving out for immigration. 
During the elder group, the proportion of female is still higher than that of male. This might be because the average age of female is higher than that of male. 


## Task 2

```{r}
pre_2017_data <- puerto_rico_counts %>%
  filter(date < as.Date("2017-01-01")) %>%
  mutate(
    year = year(date),
    week_of_year = epiweek(date)
  )

# Aggregate by year, week_of_year, agegroup, and sex, and ensure full weeks (7 distinct days)
weekly_data <- pre_2017_data %>%
  group_by(year, week_of_year, agegroup, sex) %>%
  summarise(
    weekly_outcome = sum(outcome, na.rm = TRUE),
    ndays = n_distinct(date),  # Count distinct days in this week-group
    .groups = 'drop'
  ) %>%
  filter(ndays == 7)  # Keep only full weeks

# Compute baseline statistics across all pre-2017 years
baseline_stats <- weekly_data %>%
  group_by(agegroup, sex, week_of_year) %>%
  summarise(
    mean_outcome = mean(weekly_outcome, na.rm = TRUE),
    sd_outcome = sd(weekly_outcome, na.rm = TRUE),
    .groups = 'drop'
  )

# Plot: Facet by age group, color by sex on the same plot
ggplot(baseline_stats, aes(x = week_of_year, y = mean_outcome, color = sex)) +
  geom_line() +
  facet_wrap(~ agegroup, scales = "free_y") +
  labs(
    title = "Weekly Expected Mortality (Pre-2017) by Age Group and Sex",
    x = "Week of Year",
    y = "Mean Weekly Mortality",
    color = "Sex"
  ) +
  theme_minimal()
```

**Methods**
We used historical mortality data from Puerto Rico collected before 2017 to estimate weekly expected mortality and standard deviation by age group and sex. The dataset included daily mortality counts, which we filtered for pre-2017 dates. Using the R package, we added variables for the year and ISO week to ensure standard week alignment. We calculated weekly mortality by aggregating daily counts per age group, sex, and week. Baseline statistics, including mean and standard deviation, were computed for each group. For streamlined analysis, age groups were combined based on mortality rate similarities into categories: 0-14, 15-39, 40-59, 60-74, and 75+. Visualization of these patterns was achieved using ggplot2, showing trends in mean weekly mortality by age and sex.

**Results**
The analysis shows clear mortality patterns by age and sex. Males generally exhibited higher mortality rates than females across most age groups. Mortality rates increased with age, particularly in the 75+ category. Over the weeks, mortality rates remained relatively stable, with minor fluctuations in younger groups. Combining age groups allowed us to maintain trend visibility while simplifying analysis. The visualizations highlighted these trends effectively, showing greater variability in older age groups. These patterns reflect demographic expectations, confirming the consistency and reliability of the estimated mortality statistics.

**Discussion**
The results validate expected mortality patterns, with notable higher rates in males and older demographics. The weekly stability suggests minimal impact from short-term external factors during the analyzed period. Age group combinations were effective in reducing complexity without losing critical insights. This approach is beneficial for similar studies to simplify demographic analysis. 


# Discussion (600-700 words)
Purpose: In the discussion, interpret the significance of your findings, explore potential implications, and relate the results back to your initial research questions or hypotheses. This section allows you to discuss any patterns, unexpected findings, or limitations and suggest possible future research.
Guidelines: Analyze your results in the context of your research question, linking them back to the background information from the introduction. Consider what your findings reveal, any limitations they may have, and how they might impact future work or policy. End with a brief conclusion summarizing your main insights.

